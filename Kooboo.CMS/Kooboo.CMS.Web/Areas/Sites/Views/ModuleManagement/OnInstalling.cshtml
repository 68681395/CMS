@model Kooboo.CMS.Sites.Extension.ModuleArea.ModuleInfo
@{
    ViewBag.Title = "Module installation".Localize();
    Layout = "~/Views/Shared/Blank.cshtml";
    var installingTemplate = Model.InstallingTemplate;
    if (!string.IsNullOrEmpty(installingTemplate) && !installingTemplate.StartsWith("~/"))
    {
        var viewPath =  new ModulePath(Model.ModuleName).GetModuleInstallationFilePath(installingTemplate);
        if (File.Exists(viewPath.PhysicalPath))
        {
            installingTemplate = viewPath.VirtualPath;
        }
        else
        {
            installingTemplate = null;
        }
       
    }
    var installationContext = (Kooboo.CMS.Sites.Extension.ModuleArea.Management.InstallationContext)ViewBag.InstallationContext;
}
@section Panel{
    <ul class="panel">

        <li>
            <a data-ajaxform="">
                @Html.IconImage("next") @("Next".Localize())
            </a>
        </li>
    </ul>
}
<div class="common-form">
    <h1 class="title">@ViewBag.Title</h1>
    <div class="process-steps">
        <div class="steps-inner">
            <a>@("Upload module file".Localize())</a>
            <span class="current">@("Run installation event".Localize())<b></b></span>
            <span>@("Finished".Localize())</span>
        </div>
    </div>
    <table>
        <tr>
            <th>@("Module name".Localize())</th>
            <td>@installationContext.ModuleName</td>
        </tr>
        <tr>
            <th>@("Module version".Localize())</th>
            <td>@installationContext.VersionRange.TargetVersion</td>
        </tr>
        <tr>
            <th>@("Kooboo CMS".Localize())</th>
            <td>@Model.KoobooCMSVersion</td>
        </tr>
    </table>
    @using (Html.BeginForm())
    {
        if (string.IsNullOrEmpty(installingTemplate))
        {
            <p>@("Confirm to run the 'OnInstalling' event which defined in module.".Localize())</p>
        }
        else
        {
            @Html.Partial(installingTemplate, null, new ViewDataDictionary())

        }
    }

</div>
